<?xml version="1.0" encoding="utf-8" ?>
<uranium:UraniumContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
                            xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                            xmlns:uranium="http://schemas.enisn-projects.io/dotnet/maui/uraniumui"
                            xmlns:viewmodels="clr-namespace:MeditationApp.ViewModels"
                            xmlns:converters="clr-namespace:MeditationApp.Converters"
                            x:Class="MeditationApp.Views.BreathingSettingsPage"
                            x:DataType="viewmodels:BreathingExerciseViewModel"
                            Title="Breathing Settings">

    <uranium:UraniumContentPage.Resources>
        <ResourceDictionary>
            <converters:DaySelectedConverter x:Key="DaySelectedConverter"/>
        </ResourceDictionary>
    </uranium:UraniumContentPage.Resources>

    <uranium:UraniumContentPage.Background>
        <SolidColorBrush Color="{StaticResource BackgroundColor}"/>
    </uranium:UraniumContentPage.Background>

    <Grid BackgroundColor="{StaticResource BackgroundColor}">
        <!-- Decorative abstract shapes -->
        <Ellipse WidthRequest="150"
                 HeightRequest="150"
                 Fill="#15BBDEFB"
                 HorizontalOptions="Start"
                 VerticalOptions="Start"
                 Margin="-60,30,0,0"
                 InputTransparent="True"/>

        <Ellipse WidthRequest="120"
                 HeightRequest="120"
                 Fill="#10E1BEE7"
                 HorizontalOptions="End"
                 VerticalOptions="End"
                 Margin="0,0,-50,60"
                 InputTransparent="True"/>

        <ScrollView Padding="20">
            <StackLayout Spacing="25">

                <!-- Feedback Settings -->
                <Frame BackgroundColor="White"
                       CornerRadius="15"
                       HasShadow="True"
                       Padding="20">
                    <StackLayout Spacing="15">
                        <Label Text="Feedback Settings"
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="#2E7D32"/>

                        <Grid ColumnDefinitions="*,Auto"
                              RowDefinitions="Auto">
                            <Label Grid.Row="0"
                                   Grid.Column="0"
                                   Text="Enable Haptic Feedback"
                                   VerticalOptions="Center"/>
                            <Switch Grid.Row="0"
                                    Grid.Column="1"
                                    IsToggled="{Binding Settings.EnableHapticFeedback}"/>
                        </Grid>
                    </StackLayout>
                </Frame>

                <!-- Notification Settings -->
                <Frame BackgroundColor="White"
                       CornerRadius="15"
                       HasShadow="True"
                       Padding="20">
                    <StackLayout Spacing="15">
                        <Label Text="Notification Settings"
                               FontSize="20"
                               FontAttributes="Bold"
                               TextColor="#2E7D32"/>

                        <Grid ColumnDefinitions="*,Auto"
                              RowDefinitions="Auto,Auto,Auto">
                            <Label Grid.Row="0"
                                   Grid.Column="0"
                                   Text="Enable Daily Reminders"
                                   VerticalOptions="Center"/>
                            <Switch Grid.Row="0"
                                    Grid.Column="1"
                                    IsToggled="{Binding Settings.EnableReminders}"/>

                            <!-- Reminder Time Picker -->
                            <Label Grid.Row="1"
                                   Grid.Column="0"
                                   Text="Reminder Time"
                                   VerticalOptions="Center"
                                   IsVisible="{Binding Settings.EnableReminders}"/>
                            <TimePicker Grid.Row="1"
                                        Grid.Column="1"
                                        Time="{Binding Settings.ReminderTime}"
                                        IsVisible="{Binding Settings.EnableReminders}"
                                        Format="HH:mm"/>

                            <!-- Days of Week -->
                            <Label Grid.Row="2"
                                   Grid.Column="0"
                                   Grid.ColumnSpan="2"
                                   Text="Reminder Days"
                                   VerticalOptions="Center"
                                   IsVisible="{Binding Settings.EnableReminders}"
                                   Margin="0,10,0,5"/>
                        </Grid>

                        <!-- Days of Week Selection -->
                        <StackLayout Orientation="Horizontal"
                                     Spacing="5"
                                     HorizontalOptions="Center"
                                     IsVisible="{Binding Settings.EnableReminders}">
                            <Button Text="Mon"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Monday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Monday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                            <Button Text="Tue"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Tuesday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Tuesday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                            <Button Text="Wed"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Wednesday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Wednesday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                            <Button Text="Thu"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Thursday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Thursday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                            <Button Text="Fri"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Friday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Friday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                            <Button Text="Sat"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Saturday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Saturday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                            <Button Text="Sun"
                                    Command="{Binding ToggleReminderDayCommand}"
                                    CommandParameter="Sunday"
                                    BackgroundColor="{Binding Settings, Converter={StaticResource DaySelectedConverter}, ConverterParameter=Sunday}"
                                    TextColor="White"
                                    FontSize="12"
                                    WidthRequest="40"
                                    HeightRequest="40"
                                    CornerRadius="20"/>
                        </StackLayout>
                    </StackLayout>
                </Frame>

                <!-- Save Button with enhanced visual feedback -->
                <Frame Padding="0"
                       CornerRadius="25"
                       HasShadow="True"
                       HorizontalOptions="Center"
                       HeightRequest="50"
                       WidthRequest="200"
                       BackgroundColor="#4CAF50"
                       BorderColor="Transparent">
                    <Frame.Shadow>
                        <Shadow Brush="#4CAF50"
                                Offset="0,4"
                                Radius="12"
                                Opacity="0.3"/>
                    </Frame.Shadow>
                    <Button Text="Save Settings"
                            BackgroundColor="Transparent"
                            TextColor="White"
                            FontSize="16"
                            FontAttributes="Bold"
                            HorizontalOptions="Fill"
                            VerticalOptions="Fill"
                            BorderColor="Transparent"
                            Command="{Binding SaveSettingsCommand}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroupList>
                                <VisualStateGroup x:Name="CommonStates">
                                    <VisualState x:Name="Normal">
                                        <VisualState.Setters>
                                            <Setter Property="Scale"
                                                    Value="1.0"/>
                                            <Setter Property="Opacity"
                                                    Value="1.0"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                    <VisualState x:Name="Pressed">
                                        <VisualState.Setters>
                                            <Setter Property="Scale"
                                                    Value="0.95"/>
                                            <Setter Property="Opacity"
                                                    Value="0.8"/>
                                        </VisualState.Setters>
                                    </VisualState>
                                </VisualStateGroup>
                            </VisualStateGroupList>
                        </VisualStateManager.VisualStateGroups>
                    </Button>
                </Frame>
            </StackLayout>
        </ScrollView>
    </Grid>
</uranium:UraniumContentPage>
