<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="MeditationApp.Views.TodayPage"
             Shell.NavBarIsVisible="False">

    <Grid RowDefinitions="*,Auto">
        <!-- Scrollable Content -->
        <ScrollView Grid.Row="0">
            <VerticalStackLayout Padding="20"
                                 Spacing="20">

                <!-- Header Section -->
                <VerticalStackLayout Spacing="10">
                    <Label Text="{Binding FormattedDate}"
                           Style="{StaticResource SubHeadline}"
                           HorizontalOptions="Center"/>
                    <Label Text="{Binding WelcomeMessage}"
                           Style="{StaticResource Headline}"
                           HorizontalOptions="Center"/>
                </VerticalStackLayout>

                <!-- Stats Cards -->
                <Grid ColumnDefinitions="*,*"
                      ColumnSpacing="15">

                    <!-- Today's Sessions Card -->
                    <Frame Grid.Column="0"
                           BackgroundColor="{AppThemeBinding Light={StaticResource Primary}, Dark={StaticResource PrimaryDark}}"
                           CornerRadius="15"
                           Padding="20">
                        <VerticalStackLayout Spacing="10">
                            <Label Text="Today's Sessions"
                                   TextColor="White"
                                   FontSize="14"
                                   HorizontalOptions="Center"/>
                            <Label Text="{Binding TodaySessionsCompleted}"
                                   TextColor="White"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Streak Card -->
                    <Frame Grid.Column="1"
                           BackgroundColor="{AppThemeBinding Light={StaticResource Secondary}, Dark={StaticResource SecondaryDark}}"
                           CornerRadius="15"
                           Padding="20">
                        <VerticalStackLayout Spacing="10">
                            <Label Text="Streak Days"
                                   TextColor="White"
                                   FontSize="14"
                                   HorizontalOptions="Center"/>
                            <Label Text="{Binding StreakDays}"
                                   TextColor="White"
                                   FontSize="32"
                                   FontAttributes="Bold"
                                   HorizontalOptions="Center"/>
                        </VerticalStackLayout>
                    </Frame>
                </Grid>

                <!-- Mood Selector -->
                <VerticalStackLayout Spacing="10"
                                     Padding="0,20,0,0">
                    <Label Text="How are you feeling today?"
                           HorizontalOptions="Center"
                           FontAttributes="Bold"
                           FontSize="16"/>
                    <Grid ColumnDefinitions="Auto,Auto,Auto,Auto,Auto"
                          HorizontalOptions="Center">
                        <Label Text="😢"
                               FontSize="{Binding SelectedMood, Converter={StaticResource MoodFontSizeConverter}, ConverterParameter=1}"
                               TextColor="{Binding SelectedMood, Converter={StaticResource MoodColorConverter}, ConverterParameter=1}"
                               FontAttributes="{Binding SelectedMood, Converter={StaticResource MoodFontAttributesConverter}, ConverterParameter=1}"
                               Grid.Column="0">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SelectMoodCommand}"
                                                      CommandParameter="1"/>
                            </Label.GestureRecognizers>
                        </Label>
                        <Label Text="🙁"
                               FontSize="{Binding SelectedMood, Converter={StaticResource MoodFontSizeConverter}, ConverterParameter=2}"
                               TextColor="{Binding SelectedMood, Converter={StaticResource MoodColorConverter}, ConverterParameter=2}"
                               FontAttributes="{Binding SelectedMood, Converter={StaticResource MoodFontAttributesConverter}, ConverterParameter=2}"
                               Grid.Column="1">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SelectMoodCommand}"
                                                      CommandParameter="2"/>
                            </Label.GestureRecognizers>
                        </Label>
                        <Label Text="😐"
                               FontSize="{Binding SelectedMood, Converter={StaticResource MoodFontSizeConverter}, ConverterParameter=3}"
                               TextColor="{Binding SelectedMood, Converter={StaticResource MoodColorConverter}, ConverterParameter=3}"
                               FontAttributes="{Binding SelectedMood, Converter={StaticResource MoodFontAttributesConverter}, ConverterParameter=3}"
                               Grid.Column="2">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SelectMoodCommand}"
                                                      CommandParameter="3"/>
                            </Label.GestureRecognizers>
                        </Label>
                        <Label Text="🙂"
                               FontSize="{Binding SelectedMood, Converter={StaticResource MoodFontSizeConverter}, ConverterParameter=4}"
                               TextColor="{Binding SelectedMood, Converter={StaticResource MoodColorConverter}, ConverterParameter=4}"
                               FontAttributes="{Binding SelectedMood, Converter={StaticResource MoodFontAttributesConverter}, ConverterParameter=4}"
                               Grid.Column="3">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SelectMoodCommand}"
                                                      CommandParameter="4"/>
                            </Label.GestureRecognizers>
                        </Label>
                        <Label Text="😄"
                               FontSize="{Binding SelectedMood, Converter={StaticResource MoodFontSizeConverter}, ConverterParameter=5}"
                               TextColor="{Binding SelectedMood, Converter={StaticResource MoodColorConverter}, ConverterParameter=5}"
                               FontAttributes="{Binding SelectedMood, Converter={StaticResource MoodFontAttributesConverter}, ConverterParameter=5}"
                               Grid.Column="4">
                            <Label.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding SelectMoodCommand}"
                                                      CommandParameter="5"/>
                            </Label.GestureRecognizers>
                        </Label>
                    </Grid>
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

        <!-- Anchored Button at Bottom -->
        <VerticalStackLayout Grid.Row="1"
                             Padding="20,0,20,20">
            <Button Text="Create today's session"
                    Command="{Binding StartMeditationCommand}"
                    Style="{StaticResource ButtonOutline}"
                    HeightRequest="60"
                    FontSize="16"/>
        </VerticalStackLayout>
    </Grid>
</ContentPage>
